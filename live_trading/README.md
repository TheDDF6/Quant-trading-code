# OKX实盘交易系统

基于RSI背离策略的自动化合约交易系统，支持OKX交易所永续合约和交割合约交易。

## 🚨 重要警告

**实盘交易存在重大风险，可能导致资金损失！**

- 这是实验性软件，可能存在bug
- 任何交易策略都可能失效
- 请只使用您能承受损失的资金
- 建议先在沙盒环境充分测试

## 🎯 系统特点

- **OKX API集成** - 支持永续合约和交割合约自动化交易
- **RSI背离策略** - 基于技术分析的交易信号
- **动态风险管理** - 自适应仓位大小和杠杆
- **完整风控系统** - 止损、止盈、日亏损限制
- **实时监控** - 详细日志和交易记录
- **沙盒测试** - 安全的测试环境

## 📁 目录结构

```
live_trading/
├── main.py                      # 🚀 主程序入口
├── README.md                    # 📖 本文件
├── core/                       # 🔧 核心模块
│   ├── okx_client.py           # OKX API客户端
│   └── trading_engine.py       # 交易引擎
├── strategies/                 # 📈 交易策略
│   └── rsi_divergence_live.py  # RSI背离实盘策略
├── config/                     # ⚙️ 配置管理
│   ├── config.py               # 配置管理器
│   └── trading_config.json     # 配置文件
├── data/                       # 📊 数据存储 (自动创建)
│   └── trades.json             # 交易记录
└── logs/                       # 📝 日志文件 (自动创建)
    └── trading_YYYYMMDD.log    # 日志文件
```

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install pandas numpy talib requests
```

### 2. 准备OKX API

1. 登录OKX官网
2. 前往API管理页面
3. 创建新的API密钥
4. 记录以下信息：
   - API Key
   - Secret Key  
   - Passphrase

⚠️ **API权限设置**：
- 交易权限：✅ 必须启用
- 读取权限：✅ 必须启用  
- 提币权限：❌ 建议关闭

### 3. 启动系统

```bash
cd D:\VSC\live_trading
python main.py
```

### 4. 首次配置

选择 "配置向导" 进行设置：

1. **输入API信息**
2. **选择环境**：
   - 沙盒环境（推荐，用于测试）
   - 实盘环境（真实资金）
3. **设置交易参数**：
   - 初始资金
   - 单笔风险比例
   - 最大杠杆

### 5. 测试连接

使用 "测试API连接" 验证配置是否正确。

## 💡 使用建议

### 新手使用流程

1. **沙盒测试阶段**（1-2周）：
   - 在沙盒环境测试策略
   - 观察信号质量和交易频率
   - 验证止盈止损逻辑

2. **小额实盘测试**（1个月）：
   - 使用极小资金（如$100-500）
   - 监控实际交易成本和滑点
   - 评估策略在实际环境中的表现

3. **逐步增加资金**：
   - 只有在策略表现稳定后才增加资金
   - 始终使用您能承受损失的资金

### 风控建议

- **单笔风险**: 建议1-2%，最高不超过3%
- **最大杠杆**: 新手建议5-10倍，经验丰富后可考虑更高
- **日亏损限制**: 建议3-5%
- **连续亏损**: 建议3次后暂停交易

## ⚙️ 配置说明

主要配置项在 `config/trading_config.json`：

```json
{
  "trading": {
    "symbol": "BTC-USDT-SWAP",      // 交易对
    "risk_per_trade": 0.015,        // 单笔风险1.5%
    "max_leverage": 10,             // 最大杠杆10倍
    "initial_balance": 1000.0       // 初始资金
  },
  "risk_management": {
    "max_daily_loss": 0.05,         // 日亏损限制5%
    "max_consecutive_losses": 3,     // 连续亏损3次停止
    "emergency_stop": false          // 紧急停止开关
  }
}
```

## 📊 监控和管理

### 日志监控

系统会生成详细日志：
- 交易信号和执行情况
- 持仓状态和盈亏
- 错误和警告信息

### 交易记录

所有交易记录保存在 `data/trades.json`，包括：
- 开仓/平仓时间
- 价格和数量
- 盈亏情况
- 信号类型

### 紧急停止

遇到异常情况时：
1. 使用程序内的"紧急停止开关"
2. 或直接设置 `emergency_stop: true`
3. 系统将停止所有新的交易

## ⚠️ 风险提醒

### 技术风险

- **API限制**: 超过频率限制可能导致交易失败
- **网络延迟**: 可能影响订单执行时机
- **系统故障**: 程序异常可能导致持仓管理失效

### 市场风险

- **策略失效**: RSI背离可能在某些市场条件下失效
- **极端行情**: 急剧波动可能导致大额亏损
- **流动性风险**: 大额订单可能影响市场价格

### 操作风险

- **配置错误**: 错误的参数设置可能放大风险
- **监控不足**: 长时间不监控可能错过重要问题

## 🔧 故障排除

### 常见问题

**1. API连接失败**
- 检查API密钥是否正确
- 确认API权限设置
- 检查网络连接

**2. 无法下单**
- 检查账户余额
- 确认交易对是否支持
- 验证杠杆设置

**3. 策略无信号**
- 检查市场数据是否正常
- 确认策略参数设置
- 查看日志中的详细信息

### 联系支持

遇到问题时：
1. 查看日志文件详细错误信息
2. 检查配置文件设置
3. 尝试在沙盒环境复现问题

## 📝 更新日志

- **v1.0** - 初始版本，支持RSI背离策略自动交易
- 支持OKX期货合约交易
- 完整的风控系统
- 沙盒和实盘环境

---

**免责声明**: 本软件仅供学习和研究使用，不构成投资建议。使用者需自行承担所有交易风险。